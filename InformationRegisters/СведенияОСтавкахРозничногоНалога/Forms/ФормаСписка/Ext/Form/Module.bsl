
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ИспользуетсяИзмерениеПодразделение = ПроверитьИспользованиеПодразделения();
	
КонецПроцедуры


////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

Функция ПроверитьИспользованиеПодразделения()
	
	ВедетсяУчетПоПодразделениям  = ПроцедурыБухгалтерскогоУчетаВызовСервераПовтИсп.НаСчетеВедетсяУчетПоПодразделениям(ПланыСчетов.Типовой.ДоходОтРеализацииПродукцииИОказанияУслуг_);
	
	ЕстьЗаполненныеПодразделения = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СведенияОСтавкахРозничногоНалогаСрезПоследних.Подразделение КАК Подразделение
		|ИЗ
		|	РегистрСведений.СведенияОСтавкахРозничногоНалога.СрезПоследних(, Подразделение <> &ПустоеПодразделение) КАК СведенияОСтавкахРозничногоНалогаСрезПоследних";
	
	Запрос.УстановитьПараметр("ПустоеПодразделение", Справочники.ПодразделенияОрганизаций.ПустаяСсылка());
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		ЕстьЗаполненныеПодразделения = Истина;
	КонецЕсли;
	
	Возврат ВедетсяУчетПоПодразделениям ИЛИ ЕстьЗаполненныеПодразделения;
	
КонецФункции
