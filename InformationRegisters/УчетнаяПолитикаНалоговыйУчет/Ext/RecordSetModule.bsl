#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

// Процедура - обработчик события "ПередЗаписью"
//
Процедура ПередЗаписью(Отказ, Замещение)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат
	КонецЕсли; 
	
	Для Каждого СтрокаНабора Из ЭтотОбъект Цикл
		
		Если СтрокаНабора.ПорядокОбложенияДоходовРаботников = Перечисления.ПорядокОбложенияДоходовРаботников.ЕдиныйПлатеж Тогда
			
			Если СтрокаНабора.Период < Дата('20230101') Тогда
				
				ВызватьИсключение НСтр("ru = 'Способ порядка обложения доходов работников при СНР на основе упрощенной декларации указывается с 01.01.2023'");
				
			КонецЕсли;
			
		КонецЕсли;
		
		Если СтрокаНабора.ПорядокОбложенияДоходовРаботников = Перечисления.ПорядокОбложенияДоходовРаботников.ПустаяСсылка() Тогда
			
			СтрокаНабора.ПорядокОбложенияДоходовРаботников = Перечисления.ПорядокОбложенияДоходовРаботников.Общеустановленный;
			
		КонецЕсли; 
		
		ГоловнаяОрганизация = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(СтрокаНабора.Организация, "ГоловнаяОрганизация");
				
		Если СтрокаНабора.Организация <> ГоловнаяОрганизация Тогда
			
			ПорядокОбложенияДоходовГоловнойОрганизации = РегистрыСведений.УчетнаяПолитикаНалоговыйУчет.ПолучитьПорядокОбложенияДоходовРаботниковПоОрганизациям(ГоловнаяОрганизация, СтрокаНабора.Период);	
				
			Если ПорядокОбложенияДоходовГоловнойОрганизации <> Неопределено И СтрокаНабора.ПорядокОбложенияДоходовРаботников <> ПорядокОбложенияДоходовГоловнойОрганизации Тогда 
				
				ТекстСообщения = НСтр("ru='В головной организации {" + ГоловнаяОрганизация + "} порядок обложения доходов работников указан как " + ПорядокОбложенияДоходовГоловнойОрганизации + ". Порядок обложения доходов работников у филиала не соответствует значению у головной организации. Данные не записаны'");
				ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ТекстСообщения); 
				
				Отказ = Истина;
				
			КонецЕсли;
			
		КонецЕсли;  
		
	КонецЦикла;
	
КонецПроцедуры   

#КонецЕсли

