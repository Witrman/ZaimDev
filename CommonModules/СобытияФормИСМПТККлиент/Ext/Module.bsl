
#Область Печать

// Открытвает форму печати кодов маркировки по переданным данным.
// Если передается объект документа - требует записи
// 
// Параметры:
// 	ФормаВладелец - Управляемая форма - владелец для открываемой формы печатит
// 	ДанныеОткрытия - Структура, ДанныеФормыОбъект - основание, по которому требуется открыть форму
// 	ОповещениеПриЗакрытии - Неопределено - Описание оповещения при закрытии формы печати
Процедура ОтрытьФормуПечатиКодовМаркировок(ФормаВладелец, ДанныеОткрытия, ОповещениеПриЗакрытии=Неопределено) Экспорт
	
	ОчиститьСообщения();
	
	Если ТипЗнч(ДанныеОткрытия) = Тип("Структура") Тогда
		ПараметрыФормыПечати = ДанныеОткрытия;
	Иначе
		
		Объект = ДанныеОткрытия;
		Если Объект.Ссылка.Пустая() Тогда
			ИнтеграцияИСМПТККлиентСерверПереопределяемый.СообщитьПользователю(НСтр("ru = 'Невозможно открыть форму печати для нового документа.';
																				   |en = 'Невозможно открыть форму печати для нового документа.'"));
			Возврат;
		КонецЕсли;
		
		Если ТипЗнч(Объект.Ссылка) = Тип("ДокументСсылка.НанесениеКодовМаркировкиСУЗИСМПТК") Тогда
			ДокументДляПечати = Объект.ДокументОснование;
		Иначе
			ДокументДляПечати = Объект.Ссылка;
		КонецЕсли;
		
		ПараметрыФормыПечати = Новый Структура();
		ПараметрыФормыПечати.Вставить("Документ", ДокументДляПечати);
		
	КонецЕсли;
	
	ОткрытьФорму("Обработка.ПечатьКодовМаркировкиИСМПТК.Форма.ФормаПечатиИзПула", ПараметрыФормыПечати, ЭтотОбъект,,,, ОповещениеПриЗакрытии, РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
	
КонецПроцедуры

#КонецОбласти

Процедура ПослеЗаписи(Форма, ПараметрыЗаписи) Экспорт
	
	
КонецПроцедуры

#Область СлужебныйПрограммныйИнтерфейс

Процедура СообщитьОбОшибке(РезультатВыполнения) Экспорт
	
	ТекстСообщения = НСтр("ru = 'При выполнении операции произошла ошибка:""%ОписаниеОшибки%"".';
							|en = 'При выполнении операции произошла ошибка:""%ОписаниеОшибки%"".'");
	ТекстСообщения = СтрЗаменить(ТекстСообщения, "%ОписаниеОшибки%", РезультатВыполнения.ОписаниеОшибки);
	ИнтеграцияИСМПТККлиентСерверПереопределяемый.СообщитьПользователю(ТекстСообщения);
	
КонецПроцедуры

#КонецОбласти
